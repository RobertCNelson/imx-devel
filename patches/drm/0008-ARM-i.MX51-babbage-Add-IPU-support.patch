From d86f779d52ac67c4175c423ae18021301df22f6d Mon Sep 17 00:00:00 2001
From: Sascha Hauer <s.hauer@pengutronix.de>
Date: Tue, 5 Jun 2012 13:51:46 +0200
Subject: [PATCH 08/27] ARM i.MX51 babbage: Add IPU support

Signed-off-by: Sascha Hauer <s.hauer@pengutronix.de>
---
 arch/arm/boot/dts/imx51-babbage.dts   |   12 ++++++++
 arch/arm/boot/dts/imx51.dtsi          |    7 +++++
 arch/arm/mach-imx/mach-mx51_babbage.c |   52 +++++++++++++++++++++++++++++++++
 3 files changed, 71 insertions(+)

diff --git a/arch/arm/boot/dts/imx51-babbage.dts b/arch/arm/boot/dts/imx51-babbage.dts
index de065b5..65514b2 100644
--- a/arch/arm/boot/dts/imx51-babbage.dts
+++ b/arch/arm/boot/dts/imx51-babbage.dts
@@ -22,6 +22,18 @@
 	};
 
 	soc {
+		display@di0 {
+			compatible = "fsl,imx-parallel-display";
+			crtcs = <&ipu 0>;
+			interface_pix_fmt = "rgb24";
+		};
+
+		display@di1 {
+			compatible = "fsl,imx-parallel-display";
+			crtcs = <&ipu 1>;
+			interface_pix_fmt = "rgb565";
+		};
+
 		aips@70000000 { /* aips-1 */
 			spba@70000000 {
 				esdhc@70004000 { /* ESDHC1 */
diff --git a/arch/arm/boot/dts/imx51.dtsi b/arch/arm/boot/dts/imx51.dtsi
index bfa65ab..7697130 100644
--- a/arch/arm/boot/dts/imx51.dtsi
+++ b/arch/arm/boot/dts/imx51.dtsi
@@ -58,6 +58,13 @@
 		interrupt-parent = <&tzic>;
 		ranges;
 
+		ipu: ipu@40000000 {
+			#crtc-cells = <1>;
+			compatible = "fsl,imx51-ipu";
+			reg = <0x40000000 0x20000000>;
+			interrupts = <11 10>;
+		};
+
 		aips@70000000 { /* AIPS1 */
 			compatible = "fsl,aips-bus", "simple-bus";
 			#address-cells = <1>;
diff --git a/arch/arm/mach-imx/mach-mx51_babbage.c b/arch/arm/mach-imx/mach-mx51_babbage.c
index dde3970..bf6d949 100644
--- a/arch/arm/mach-imx/mach-mx51_babbage.c
+++ b/arch/arm/mach-imx/mach-mx51_babbage.c
@@ -169,6 +169,58 @@ static iomux_v3_cfg_t mx51babbage_pads[] = {
 	MX51_PAD_AUD3_BB_RXD__AUD3_RXD,
 	MX51_PAD_AUD3_BB_CK__AUD3_TXC,
 	MX51_PAD_AUD3_BB_FS__AUD3_TXFS,
+
+	/* Display */
+	MX51_PAD_DISPB2_SER_DIN__GPIO3_5,
+	MX51_PAD_DISPB2_SER_DIO__GPIO3_6,
+	MX51_PAD_NANDF_D12__GPIO3_28,
+
+	MX51_PAD_DISP1_DAT0__DISP1_DAT0,
+	MX51_PAD_DISP1_DAT1__DISP1_DAT1,
+	MX51_PAD_DISP1_DAT2__DISP1_DAT2,
+	MX51_PAD_DISP1_DAT3__DISP1_DAT3,
+	MX51_PAD_DISP1_DAT4__DISP1_DAT4,
+	MX51_PAD_DISP1_DAT5__DISP1_DAT5,
+	MX51_PAD_DISP1_DAT6__DISP1_DAT6,
+	MX51_PAD_DISP1_DAT7__DISP1_DAT7,
+	MX51_PAD_DISP1_DAT8__DISP1_DAT8,
+	MX51_PAD_DISP1_DAT9__DISP1_DAT9,
+	MX51_PAD_DISP1_DAT10__DISP1_DAT10,
+	MX51_PAD_DISP1_DAT11__DISP1_DAT11,
+	MX51_PAD_DISP1_DAT12__DISP1_DAT12,
+	MX51_PAD_DISP1_DAT13__DISP1_DAT13,
+	MX51_PAD_DISP1_DAT14__DISP1_DAT14,
+	MX51_PAD_DISP1_DAT15__DISP1_DAT15,
+	MX51_PAD_DISP1_DAT16__DISP1_DAT16,
+	MX51_PAD_DISP1_DAT17__DISP1_DAT17,
+	MX51_PAD_DISP1_DAT18__DISP1_DAT18,
+	MX51_PAD_DISP1_DAT19__DISP1_DAT19,
+	MX51_PAD_DISP1_DAT20__DISP1_DAT20,
+	MX51_PAD_DISP1_DAT21__DISP1_DAT21,
+	MX51_PAD_DISP1_DAT22__DISP1_DAT22,
+	MX51_PAD_DISP1_DAT23__DISP1_DAT23,
+
+	MX51_PAD_DISP2_DAT0__DISP2_DAT0,
+	MX51_PAD_DISP2_DAT1__DISP2_DAT1,
+	MX51_PAD_DISP2_DAT2__DISP2_DAT2,
+	MX51_PAD_DISP2_DAT3__DISP2_DAT3,
+	MX51_PAD_DISP2_DAT4__DISP2_DAT4,
+	MX51_PAD_DISP2_DAT5__DISP2_DAT5,
+	MX51_PAD_DISP2_DAT6__DISP2_DAT6,
+	MX51_PAD_DISP2_DAT7__DISP2_DAT7,
+	MX51_PAD_DISP2_DAT8__DISP2_DAT8,
+	MX51_PAD_DISP2_DAT9__DISP2_DAT9,
+	MX51_PAD_DISP2_DAT10__DISP2_DAT10,
+	MX51_PAD_DISP2_DAT11__DISP2_DAT11,
+	MX51_PAD_DISP2_DAT12__DISP2_DAT12,
+	MX51_PAD_DISP2_DAT13__DISP2_DAT13,
+	MX51_PAD_DISP2_DAT14__DISP2_DAT14,
+	MX51_PAD_DISP2_DAT15__DISP2_DAT15,
+	MX51_PAD_DI2_PIN2__DI2_PIN2,
+	MX51_PAD_DI2_PIN3__DI2_PIN3,
+	MX51_PAD_DI_GP4__DI2_PIN15,
+	MX51_PAD_DI2_DISP_CLK__DI2_DISP_CLK,
+	MX51_PAD_DISPB2_SER_RS__GPIO3_8,
 };
 
 /* Serial ports */
-- 
1.7.10.4

