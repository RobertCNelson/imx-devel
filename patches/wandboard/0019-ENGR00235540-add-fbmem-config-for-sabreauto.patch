From 8fbc236195e44624738803bbfd032017ca5b66df Mon Sep 17 00:00:00 2001
From: b02247 <b02247@freescale.com>
Date: Mon, 3 Dec 2012 15:46:14 +0800
Subject: [PATCH 19/54] ENGR00235540 add "fbmem" config for sabreauto

add "fbmem" config for sabreauto_6q

Signed-off-by: Shengjiu Wang <b02247@freescale.com>
---
 arch/arm/mach-mx6/board-mx6q_sabreauto.c |   13 +++++++++++++
 1 file changed, 13 insertions(+)

diff --git a/arch/arm/mach-mx6/board-mx6q_sabreauto.c b/arch/arm/mach-mx6/board-mx6q_sabreauto.c
index 5b19333..1fb47b0 100644
--- a/arch/arm/mach-mx6/board-mx6q_sabreauto.c
+++ b/arch/arm/mach-mx6/board-mx6q_sabreauto.c
@@ -1323,9 +1323,22 @@ static void __init fixup_mxc_board(struct machine_desc *desc, struct tag *tags,
 {
 	char *str;
 	struct tag *t;
+	int i = 0;
+	struct ipuv3_fb_platform_data *pdata_fb = sabr_fb_data;
 
 	for_each_tag(t, tags) {
 		if (t->hdr.tag == ATAG_CMDLINE) {
+			str = t->u.cmdline.cmdline;
+			str = strstr(str, "fbmem=");
+			if (str != NULL) {
+				str += 6;
+				pdata_fb[i++].res_size[0] = memparse(str, &str);
+				while (*str == ',' &&
+					i < ARRAY_SIZE(sabr_fb_data)) {
+					str++;
+					pdata_fb[i++].res_size[0] = memparse(str, &str);
+				}
+			}
 			/* GPU reserved memory */
 			str = t->u.cmdline.cmdline;
 			str = strstr(str, "gpumem=");
-- 
1.7.10.4

